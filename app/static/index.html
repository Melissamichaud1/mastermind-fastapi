<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Mastermind (FastAPI)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Custom font for the main headings -->
    <style>
      @font-face {
        font-family: "MightySouly";
        src: url("./fonts/MightySouly-lxggD.ttf") format("truetype");
        font-weight: 400;
        font-style: normal;
        font-display: swap;
      }
    </style>

    <!-- Poppins for body text -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* ========= THEME VARIABLES ========= */
      :root {
        --radius: 14px;

        /* shared pink accents */
        --accent: #e467a3;
        --accent2: #ff86cf;
        --accent3: #ffc0e6;

        /* dark theme (default) */
        --bg: #9f708f;
        --bg2: #9f708f;
        --panel: #331529;
        --panelBorder: #4a1f3a;
        --text: #fff4fb;
        --subtext: #ffd7ec;
        --muted: #6f3158;
        --rowStripe: rgba(255, 134, 207, 0.06);
        --good: #7cecc9;

        --btnShadow: rgba(255, 134, 207, 0.28);
        --descTint: rgba(255, 134, 207, 0.08);
        --tableStripeOpacity: 0.06;
        --inputBg: #220c1b;

        /* button gradient */
        --btnFrom: var(--accent2);
        --btnTo: var(--accent);
        --btnSecondaryFrom: #f8c3e4;
        --btnSecondaryTo: #ff86cf;
        --btnText: #ffffff;
      }
      :root[data-theme="light"] {
        --bg: #e7cad5;
        --bg2: #e7cad5;
        --panel: #ffffff;
        --panelBorder: #ffd2ea;
        --text: #3a152e;
        --subtext: #6a2c53;
        --muted: #eec2da;
        --rowStripe: rgba(255, 134, 207, 0.14);
        --good: #2aa989;

        --btnShadow: rgba(255, 134, 207, 0.22);
        --descTint: rgba(255, 134, 207, 0.12);
        --tableStripeOpacity: 0.12;
        --inputBg: #fff7fb;

        --btnFrom: var(--accent2);
        --btnTo: var(--accent);
        --btnSecondaryFrom: #f8c3e4;
        --btnSecondaryTo: #ff86cf;
        --btnText: #ffffff;
      }

      /* ========= LINKEDIN THEME ========= */
      :root[data-theme="linkedin"] body {
        /* light fade overlay + image in one background declaration */

        background: linear-gradient(
            rgba(255, 255, 255, 0.65),
            rgba(255, 255, 255, 0.65)
          ),
          url("/img/linkedin-bg.jpg") center center / cover no-repeat fixed;
        color: var(--text);

        /* LinkedIn brand blues */
        --liBlue: #0a66c2;
        --liBlueDark: #004182;

        --bg: #8dafdd;
        --bg2: #8dafdd;
        --panel: #eaf3ff;
        --panelBorder: #0a53a6;
        --text: #1d2a3b;
        --subtext: #485a6a;
        --muted: #dfe8f5;
        --rowStripe: rgba(10, 102, 194, 0.08);
        --good: #0a8c6a;

        --btnShadow: rgba(10, 102, 194, 0.18);
        --descTint: rgba(10, 102, 194, 0.08);
        --tableStripeOpacity: 0.1;
        --inputBg: #f9fbff;

        /* override accents to blue family */
        --accent: var(--liBlue);
        --accent2: #3f8fd9;
        --accent3: #a9cdf2;

        /* buttons go blue */
        --btnFrom: var(--liBlue);
        --btnTo: var(--liBlueDark);
        --btnSecondaryFrom: #e5f1ff;
        --btnSecondaryTo: #cfe6ff;
        --btnText: #ffffff;
      }

      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }

      body {
        margin: 0;
        background: linear-gradient(180deg, var(--bg), var(--bg2) 70%);
        color: var(--text);
        font-family: Poppins, system-ui, -apple-system, Segoe UI, Roboto, Arial,
          sans-serif;
        display: flex;
        align-items: flex-start;
        justify-content: center;
        padding: 16px 24px 32px;
        line-height: 1.6;
        transition: background 0.25s ease, color 0.25s ease;
      }

      .container {
        width: 100%;
        max-width: 1080px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 20px;
        text-align: center;
      }

      /* Top bar: title stays centered, theme toggle sits on the right */
      .topbar {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }

      h1 {
        font-family: "MightySouly", Poppins, sans-serif;
        font-size: 55px;
        margin: 0;
        letter-spacing: 0.2px;
        line-height: 1.1;
      }

      h2,
      h3,
      h4,
      h5,
      h6 {
        font-family: "MightySouly", Poppins, sans-serif;
      }
      h2 {
        font-size: 30px;
        font-weight: 400;
        letter-spacing: 0.6px;
      }

      .subtitle {
        color: var(--subtext);
        font-size: 14px;
        margin-top: 4px;
      }

      /* ---- HERO (centered under the H1) ---- */
      .hero-wrap {
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 6px 0 12px;
        position: relative;
      }

      /* Pink pegs (default theme) */
      .hero {
        display: flex;
        gap: 10px;
        justify-content: center;
      }
      .peg {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: var(--accent);
        box-shadow: 0 0 12px rgba(255, 79, 163, 0.45),
          inset 0 0 4px rgba(255, 255, 255, 0.15);
        animation: pop 1.4s ease-in-out infinite;
      }
      .peg:nth-child(2) {
        animation-delay: 0.15s;
        background: var(--accent2);
      }
      .peg:nth-child(3) {
        animation-delay: 0.3s;
        background: var(--accent3);
      }
      .peg:nth-child(4) {
        animation-delay: 0.45s;
        background: var(--accent2);
      }
      .peg:nth-child(5) {
        animation-delay: 0.6s;
        background: var(--accent);
      }

      @keyframes pop {
        0%,
        100% {
          transform: translateY(0) scale(1);
          filter: brightness(1);
        }
        50% {
          transform: translateY(-6px) scale(1.08);
          filter: brightness(1.2);
        }
      }

      /* LinkedIn logo (only shown in LinkedIn theme) */
      .li-hero {
        display: none;
        justify-content: center;
        width: 100%;
        margin-top: 4px;
      }
      .li-badge {
        width: 60px;
        height: 60px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #0a66c2;
        box-shadow: 0 6px 16px rgba(10, 102, 194, 0.25);
      }
      .li-badge svg {
        width: 36px;
        height: 36px;
        fill: white;
      }

      /* Swap pegs ‚Üî LinkedIn badge in LinkedIn theme */
      :root[data-theme="linkedin"] .hero {
        display: none;
      }
      :root[data-theme="linkedin"] .li-hero {
        display: flex;
      }

      /* ---- PANELS ---- */
      .desc {
        max-width: 860px;
        color: var(--subtext);
        background: linear-gradient(180deg, var(--descTint), transparent),
          var(--panel);
        border: 1px solid var(--panelBorder);
        border-radius: var(--radius);
        padding: 16px 18px;
        text-align: left;
        box-shadow: 0 10px 24px var(--btnShadow),
          inset 0 0 0.5px rgba(255, 255, 255, 0.12);
      }
      .desc p {
        margin: 8px 0;
      }

      .grid {
        width: 100%;
        display: grid;
        grid-template-columns: 1fr;
        gap: 22px;
      }
      @media (min-width: 980px) {
        .grid {
          grid-template-columns: 1.25fr 0.9fr;
          gap: 22px;
        }
      }

      .panel {
        background: linear-gradient(180deg, var(--descTint), transparent),
          var(--panel);
        border: 1px solid var(--panelBorder);
        border-radius: var(--radius);
        padding: 20px;
        box-shadow: 0 12px 28px var(--btnShadow),
          inset 0 0 0.5px rgba(255, 255, 255, 0.12);
        transition: background 0.25s ease, color 0.25s ease,
          border-color 0.25s ease;
        width: 100%;
        max-width: 720px; /* keep panels from growing too wide */
        margin-inline: auto; /* center the panels */
      }

      .row {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        align-items: center;
        justify-content: center;
      }
      .stack {
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: center;
      }

      .badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        background: rgba(255, 134, 207, 0.12);
        border: 1px solid var(--panelBorder);
        padding: 8px 12px;
        border-radius: 999px;
        color: var(--subtext);
        font-size: 13px;
      }
      /* Linkedin Badge color */
      :root[data-theme="linkedin"] .badge {
        background: rgba(10, 102, 194, 0.12); /* LinkedIn blue tint */
        border-color: #0a66c2; /* LinkedIn border */
        color: #0a66c2; /* Optional: make text blue */
      }

      select,
      input[type="text"] {
        background: var(--inputBg);
        color: var(--text);
        border: 1px solid var(--muted);
        border-radius: 12px;
        padding: 12px 14px;
        outline: none;
        min-width: 260px;
      }

      button {
        background: linear-gradient(180deg, var(--btnFrom), var(--btnTo));
        color: var(--btnText);
        border: none;
        border-radius: 12px;
        padding: 12px 16px;
        cursor: pointer;
        font-weight: 700;
        letter-spacing: 0.2px;
        box-shadow: 0 8px 18px var(--btnShadow);
        transition: transform 0.06s ease;
      }
      button:active {
        transform: translateY(1px);
      }
      .visually-hidden {
        position: absolute !important;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0 0 0 0);
        white-space: nowrap;
        border: 0;
      }

      /* Compact, pill-style theme <select> for theme dropdown*/
      .topbar .theme-select {
        width: auto;
        min-width: unset;
        max-width: 200px;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        border: none;
        border-radius: 999px;
        padding: 10px 32px;
        font-weight: 700;
        font-size: 15px;
        cursor: pointer;
        color: #1d2a3b;
        background: linear-gradient(
          180deg,
          var(--btnSecondaryFrom),
          var(--btnSecondaryTo)
        );
        box-shadow: 0 8px 18px var(--btnShadow);
        line-height: 1.3;
        text-align: center;
        text-align-last: center;
      }

      /* Custom arrow */
      .topbar .theme-select {
        background-image: linear-gradient(
            180deg,
            var(--btnSecondaryFrom),
            var(--btnSecondaryTo)
          ),
          url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'><path fill='%231d2a3b' d='M1 0l4 4 4-4 1 1-5 5-5-5z'/></svg>");
        background-repeat: no-repeat, no-repeat;
        background-position: left top, right 10px center;
        background-size: auto, 10px 6px;
      }

      .theme-select::-ms-expand {
        display: none;
      }

      @media (max-width: 600px) {
        .topbar {
          justify-content: center;
        }
        .topbar .theme-select {
          width: 100%;
          max-width: 260px;
        }
      }

      /* Hide-only label for accessibility */
      .visually-hidden {
        position: absolute !important;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0 0 0 0);
        white-space: nowrap;
        border: 0;
      }

      .secondary {
        background: linear-gradient(
          180deg,
          var(--btnSecondaryFrom),
          var(--btnSecondaryTo)
        );
        color: #1d2a3b;
      }

      .help {
        color: var(--subtext);
        font-size: 14px;
      }
      .spacer {
        height: 40px;
      }

      /* ---- TABLES ---- */
      .table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        border: 1px solid var(--panelBorder);
        table-layout: fixed; /* prevents columns from blowing out */
        word-break: break-word;
      }
      .table th,
      .table td {
        border-bottom: 1px solid var(--panelBorder);
        padding: 10px 12px;
        text-align: left;
        font-size: 14px;
      }
      .table th {
        color: #ffd1ea;
        font-weight: 600;
      }
      :root[data-theme="light"] .table th {
        color: #7a2b55;
      }
      :root[data-theme="linkedin"] .table th {
        color: #2f477a;
      }
      .table tr:nth-child(even) {
        background-color: var(--rowStripe);
      }

      .table-wrap {
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        margin-inline: auto;
      }
      /* Table header label swapping */
      .th-long {
        display: inline;
      }
      .th-short {
        display: none;
      }

      .nowrap {
        white-space: nowrap;
      }
      .mono {
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas,
          "Liberation Mono", monospace;
      }

      /* "Last Guess" pills */
      .pills {
        display: inline-flex;
        gap: 8px;
        align-items: center;
      }
      .pill {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 999px;
        background: var(--accent);
        color: #fff;
        font-weight: 700;
        font-size: 12px;
      }

      .note {
        color: var(--subtext);
        font-size: 15px;
      }
      .secret {
        font-weight: 800;
        color: var(--good);
      }

      /* Scoreboard */
      .jsonBox {
        white-space: pre-wrap;
        background: var(--inputBg);
        border: 1px solid var(--muted);
        padding: 12px;
        border-radius: 12px;
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
        font-size: 12.5px;
        color: #ffe2f3;
      }
      :root[data-theme="light"] .jsonBox {
        color: #5a2a45;
      }
      :root[data-theme="linkedin"] .jsonBox {
        color: #26415f;
      }

      /* Stats table headings centered */
      .stats-table .section-head {
        text-align: center;
        font-weight: 700;
        letter-spacing: 0.2px;
        padding: 10px 0;
      }

      /* ---- MOBILE FRIENDLY ---- */
      @media (max-width: 600px) {
        body {
          padding: 12px 14px 24px;
        }

        h1 {
          font-size: 38px;
        }
        h2 {
          font-size: 22px;
        }

        .peg {
          width: 12px;
          height: 12px;
        }

        select,
        input[type="text"] {
          min-width: 0;
          width: 100%;
        }
        .row {
          gap: 10px;
          justify-content: center;
        }
        .row button {
          width: 100%;
        }

        #game-info {
          justify-content: center;
        }
        .badge {
          margin: 2px;
        }
        .topbar {
          justify-content: center;
        }

        .desc {
          padding: 14px;
        }
        .panel {
          padding: 16px;
        }

        .table th,
        .table td {
          padding: 8px;
          font-size: 13px;
        }
        /* On phones: hide long labels, show compact ones */
        .th-long {
          display: none !important;
        }
        .th-short {
          display: inline !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="container" id="page">
      <div class="topbar">
        <div style="visibility: hidden">.</div>
        <label for="theme-select" class="visually-hidden">Theme</label>
        <select id="theme-select" class="theme-select" title="Choose theme">
          <option value="dark">Dark Mode üåô</option>
          <option value="light">Light Mode ‚òÄÔ∏è</option>
          <option value="linkedin">LinkedIn Mode üîµ</option>
        </select>
      </div>

      <h1>Mastermind</h1>
      <div class="hero-wrap">
        <!-- Pink pegs (visible in dark/light) -->
        <div class="hero">
          <div class="peg"></div>
          <div class="peg"></div>
          <div class="peg"></div>
          <div class="peg"></div>
          <div class="peg"></div>
        </div>

        <!-- LinkedIn badge (visible in linkedin theme) -->
        <div class="li-hero">
          <div class="li-badge" aria-label="LinkedIn">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path
                d="M4.98 3.5C4.98 4.88 3.86 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM.5 8h4V24h-4V8zm7.5 0h3.8v2.2h.05c.53-1 1.83-2.2 3.77-2.2 4.03 0 4.77 2.65 4.77 6.1V24h-4v-7.4c0-1.76-.03-4.02-2.45-4.02-2.45 0-2.82 1.9-2.82 3.88V24h-4V8z"
              />
            </svg>
          </div>
        </div>
      </div>

      <!-- Game instructions -->
      <div class="desc">
        <p>
          <b>How to play:</b> The server creates a secret code using numbers
          0‚Äì7. You have a limited number of attempts to guess the code.
        </p>
        <p>After each guess you get feedback:</p>
        <ul style="margin: 8px 0 0 18px; padding: 0">
          <li>
            <b>Correct numbers</b> ‚Äî How many of your numbers appear anywhere in
            the secret.
          </li>
          <li>
            <b>Correct positions</b> ‚Äî How many numbers are in the correct
            index(s).
          </li>
        </ul>
        <p style="margin: 8px 0 0 0">
          Numbers may repeat. Difficulty sets code length & attempts.
        </p>
      </div>

      <div class="grid">
        <!-- LEFT: Game area -->
        <div class="panel">
          <h2>New Game</h2>
          <div class="row" style="margin-bottom: 10px">
            <select id="difficulty">
              <option value="easy">Easy (3 digits)</option>
              <option value="medium" selected>Medium (4 digits)</option>
              <option value="hard">Hard (5 digits)</option>
            </select>
            <button id="start-btn" class="btn-pink">Start Game</button>
          </div>

          <!-- Game state info -->
          <div class="row" id="game-info" style="gap: 10px; margin-bottom: 6px">
            <span class="badge">Game ID: <b>none</b></span>
            <span class="badge">Attempts: -</span>
            <span class="badge">Status: -</span>
            <span class="badge">Difficulty: -</span>
          </div>

          <div class="spacer"></div>
          <h2>Make a Guess</h2>
          <div class="stack">
            <div class="help" id="guess-help">
              Enter 4 digits (0‚Äì7), separated by spaces. Example:
              <code>0 1 2 3</code>
            </div>
            <div class="row">
              <input id="guess-input" type="text" placeholder="0 1 2 3" />
              <button id="guess-btn" class="btn-pink">Submit Guess</button>
              <button id="hint-btn" class="secondary">Get Hint</button>
            </div>

            <!-- Last guess card -->
            <div
              id="last-guess"
              class="panel"
              style="margin-top: 10px; display: none; padding: 12px"
            >
              <div class="pills" style="margin-bottom: 6px">
                <span id="pill-numbers" class="pill">Numbers: 0</span>
                <span id="pill-positions" class="pill">Positions: 0</span>
              </div>
              <div class="mono nowrap" id="last-guess-array">[‚Äî]</div>
              <div
                id="last-guess-message"
                class="help"
                style="margin-top: 6px"
              ></div>
            </div>

            <!-- WIN/LOSE message + secret code -->
            <div id="final-note" class="note"></div>
            <div id="secret-box" class="note"></div>

            <div class="help" id="hint-result"></div>
            <div id="last-feedback" class="help"></div>
          </div>

          <div class="spacer"></div>
          <h2>History of Guesses</h2>
          <div class="table-wrap">
            <table class="table">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Guess</th>
                  <th>
                    <span class="th-long">Correct Number(s)</span>
                    <span class="th-short">‚úîÔ∏è Numbers</span>
                  </th>
                  <th>
                    <span class="th-long">Correct Position(s)</span>
                    <span class="th-short">‚úîÔ∏è Positions</span>
                  </th>
                  <th>Message</th>
                </tr>
              </thead>
              <tbody id="history-body"></tbody>
            </table>
          </div>
        </div>

        <!-- RIGHT: Scoreboard -->
        <div class="panel">
          <h2>Scoreboard</h2>
          <div class="row" style="margin-bottom: 8px">
            <button id="refresh-stats" class="btn-pink">Refresh Stats</button>
            <button id="reset-stats" class="btn-pink">Reset Stats</button>
          </div>
          <div id="stats-msg" class="help" style="margin-bottom: 6px"></div>
          <div class="table-wrap">
            <div id="stats-json" class="jsonBox"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Theme toggle: cycles dark -> light -> linkedin -->
    <script>
      (function () {
        const THEMES = ["dark", "light", "linkedin"];
        const root = document.documentElement;
        const select = document.getElementById("theme-select");

        // load & apply saved theme
        let saved = localStorage.getItem("mm-theme") || "dark";
        if (!THEMES.includes(saved)) saved = "dark";
        root.setAttribute("data-theme", saved);
        select.value = saved;

        // switch theme on change
        select.addEventListener("change", () => {
          const next = select.value;
          root.setAttribute("data-theme", next);
          localStorage.setItem("mm-theme", next);
        });
      })();
    </script>

    <!-- API logic -->
    <script src="./app.js"></script>
  </body>
</html>
